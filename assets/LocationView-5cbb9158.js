import{_ as h,c as d,o as c,a as i,b as o,n as k,t as l,F as z,r as S,d as A,e as y,f as L,C,u as q,g as N,h as g,i as m,w as b,j as w,k as x,l as B,m as D,p as P}from"./index-f79c51ae.js";const M={name:"ProgressBar",props:{currentStep:{type:Number,required:!0},totalSteps:{type:Number,required:!0}},setup(n){return{progressPercent:d(()=>n.currentStep/n.totalSteps*100)}}},Q={class:"progress-container"},F={class:"progress-bar"},T={class:"progress-text"};function V(n,t,s,e,u,_){return c(),i("div",Q,[o("div",F,[o("div",{class:"progress-fill",style:k({width:e.progressPercent+"%"})},null,4)]),o("div",T," 进度: "+l(s.currentStep)+"/"+l(s.totalSteps)+" ("+l(Math.round(e.progressPercent))+"%) ",1)])}const $=h(M,[["render",V],["__scopeId","data-v-be1bcfe7"]]);const H={name:"AdventureLog",props:{entries:{type:Array,default:()=>[]},currentStep:{type:Number,default:0}},computed:{displayedEntries(){return this.entries.slice(0,this.currentStep)}}},I={class:"adventure-log"},j={class:"log-entries"},E={class:"log-icon"},O=["innerHTML"];function R(n,t,s,e,u,_){return c(),i("div",I,[t[0]||(t[0]=o("h3",null,"冒险日志",-1)),o("div",j,[(c(!0),i(z,null,S(_.displayedEntries,(a,r)=>(c(),i("div",{key:r,class:"log-entry"},[o("span",E,l(a.effect),1),o("span",{class:"log-text",innerHTML:a.text},null,8,O)]))),128))])])}const U=h(H,[["render",R],["__scopeId","data-v-e52b8e44"]]);const G={name:"QuizComponent",props:{quiz:{type:Object,required:!0}},emits:["answer"],setup(n,{emit:t}){const s=A(null),e=A(!1),u=r=>{if(e.value)return;s.value=r,e.value=!0;const p=r===n.quiz.answer;t("answer",p)},_=d(()=>s.value===n.quiz.answer?n.quiz.correctMsg:n.quiz.wrongMsg),a=d(()=>s.value===n.quiz.answer?"correct":"wrong");return{selectedAnswer:s,showFeedback:e,selectAnswer:u,feedbackMessage:_,feedbackClass:a}}},J={class:"quiz-component"},K={class:"quiz-question"},W={class:"quiz-options"},X=["onClick","disabled"],Y={key:0,class:"quiz-feedback"};function Z(n,t,s,e,u,_){return c(),i("div",J,[o("div",K,[o("h3",null,l(s.quiz.question),1)]),o("div",W,[(c(!0),i(z,null,S(s.quiz.options,(a,r)=>(c(),i("button",{key:r,class:y(["quiz-option",{correct:e.selectedAnswer===r&&e.showFeedback&&r===s.quiz.answer,wrong:e.selectedAnswer===r&&e.showFeedback&&r!==s.quiz.answer}]),onClick:p=>e.selectAnswer(r),disabled:e.showFeedback},l(a),11,X))),128))]),e.showFeedback?(c(),i("div",Y,[o("p",{class:y(e.feedbackClass)},l(e.feedbackMessage),3)])):L("",!0)])}const ee=h(G,[["render",Z],["__scopeId","data-v-19a15b5d"]]);const te={name:"AdventureArea",components:{ColorButton:C,QuizComponent:ee},props:{locationName:String,adventureData:Array,theme:Object},setup(n){const t=q();N();const s=d(()=>({forest:"你走进了一片神秘的森林，阳光斑驳，鸟鸣阵阵。",mountain:"你站在高山之巅，寒风呼啸，云雾缭绕，远眺群山。",beach:"金色沙滩，碧蓝海水，阳光温暖，海鸟飞翔。"})[n.locationName]||"一个神秘的地方等待你的探索..."),e=d(()=>t.getters.getUserProgress(n.locationName).step),u=d(()=>n.adventureData.length),_=d(()=>n.adventureData[e.value-1]||{}),a=()=>{t.dispatch("updateProgress",{location:n.locationName,step:1,finished:!1})},r=()=>{const v=e.value+1,f=v>u.value;t.dispatch("updateProgress",{location:n.locationName,step:v,finished:f})};return{locationDescription:s,currentStep:e,totalSteps:u,currentAdventure:_,startAdventure:a,nextStep:r,handleQuizAnswer:v=>{v&&setTimeout(r,1200)}}}},ne={class:"adventure-area"},se={key:0,class:"welcome-message"},oe={key:1,class:"adventure-step"},re={class:"step-content"},ae={class:"step-icon"},ce=["innerHTML"],ie={key:1,class:"step-actions"},le={key:2,class:"completion-message"};function de(n,t,s,e,u,_){const a=g("ColorButton"),r=g("QuizComponent");return c(),i("div",ne,[e.currentStep===0?(c(),i("div",se,[o("h2",null,"欢迎来到 "+l(s.theme.name)+"！",1),o("p",null,l(e.locationDescription),1),m(a,{color:"green",onClick:e.startAdventure},{default:b(()=>[...t[1]||(t[1]=[w(" 开始冒险 ",-1)])]),_:1},8,["onClick"])])):e.currentStep<=e.totalSteps?(c(),i("div",oe,[o("div",re,[o("div",ae,l(e.currentAdventure.effect),1),o("div",{class:"step-text",innerHTML:e.currentAdventure.text},null,8,ce)]),e.currentAdventure.quiz?(c(),x(r,{key:0,quiz:e.currentAdventure.quiz,onAnswer:e.handleQuizAnswer},null,8,["quiz","onAnswer"])):(c(),i("div",ie,[m(a,{color:"blue",onClick:e.nextStep},{default:b(()=>[...t[2]||(t[2]=[w(" 继续冒险 ",-1)])]),_:1},8,["onClick"])]))])):(c(),i("div",le,[t[4]||(t[4]=o("div",{class:"completion-icon"},"🎉",-1)),o("h3",null,"恭喜你完成 "+l(s.theme.name)+" 的冒险！",1),t[5]||(t[5]=o("p",null,"快去探索其他地点吧！",-1)),m(a,{color:"green",onClick:t[0]||(t[0]=p=>n.$router.push("/"))},{default:b(()=>[...t[3]||(t[3]=[w(" 返回地图 ",-1)])]),_:1})]))])}const ue=h(te,[["render",de],["__scopeId","data-v-b7884fb3"]]);const _e={name:"LocationView",components:{ProgressBar:$,AdventureLog:U,AdventureArea:ue,ColorButton:C},setup(){const n=q(),s=B().params.name,e=d(()=>D[s]||{}),u=d(()=>P[s]||[]),_=d(()=>n.getters.getUserProgress(s)),a=d(()=>_.value.step),r=d(()=>u.value.length),p=d(()=>({background:e.value.background,minHeight:"100vh",padding:"20px 0"}));return{locationName:s,theme:e,adventureData:u,currentStep:a,totalSteps:r,locationStyle:p,getLocationDescription:f=>({forest:"你走进了一片神秘的森林，阳光斑驳，鸟鸣阵阵。",mountain:"你站在高山之巅，寒风呼啸，云雾缭绕，远眺群山。",beach:"金色沙滩，碧蓝海水，阳光温暖，海鸟飞翔。"})[f]||"一个神秘的地方等待你的探索..."}}},ve={class:"container"},pe={class:"location-header"},me={class:"location-controls"};function ge(n,t,s,e,u,_){const a=g("ProgressBar"),r=g("AdventureLog"),p=g("AdventureArea"),v=g("ColorButton");return c(),i("div",{class:"location-view",style:k(e.locationStyle)},[o("div",ve,[o("div",pe,[o("h1",null,l(e.theme.icon)+" "+l(e.theme.name),1),o("p",null,l(e.getLocationDescription(e.locationName)),1)]),m(a,{"current-step":e.currentStep,"total-steps":e.totalSteps},null,8,["current-step","total-steps"]),m(r,{entries:e.adventureData,"current-step":e.currentStep},null,8,["entries","current-step"]),m(p,{"location-name":e.locationName,"adventure-data":e.adventureData,theme:e.theme},null,8,["location-name","adventure-data","theme"]),o("div",me,[m(v,{color:"blue",onClick:t[0]||(t[0]=f=>n.$router.push("/"))},{default:b(()=>[...t[1]||(t[1]=[w(" 🗺️ 返回地图 ",-1)])]),_:1})])])],4)}const be=h(_e,[["render",ge],["__scopeId","data-v-a65cd4e5"]]);export{be as default};
